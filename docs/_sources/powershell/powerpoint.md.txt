# PowerPoint

## 新しいプレゼンテーションを作る。

```powershell
$Application = New-Object -ComObject PowerPoint.Application
$Application.Visible = [Microsoft.Office.Core.MsoTriState]::msoTrue
$Presentation = $Application.Presentations.Add()
```

## プレゼンテーションにスライドを加える。

```powershell
$Presentation.SlideMaster.CustomLayouts |
    ForEach-Object { $_.Name }

$CustomLayoutName = 'タイトルとコンテンツ'

$CustomLayout = $Presentation.SlideMaster.CustomLayouts |
    Where-Object { $_.Name -eq $CustomLayoutName } |
    Select-Object -First 1
if ($null -eq $CustomLayout) {
    throw
}

$Slide = $Presentation.Slides.AddSlide(1, $CustomLayout)
```

## スライドのコンテンツのテキストを設定する。

コンテンツの正体は図形なので、図形のテキストを設定する。

```powershell
$Slide.Shapes |
    ForEach-Object { $_.Name }

$ShapeName = 'Content Placeholder 2'

$Shape = $Slide.Shapes |
    Where-Object { $_.Name -match $ShapeName } |
    Select-Object -First 1
if ($null -eq $Shape) {
    throw
}

$CrLf = "`r`n"

$Shape.TextFrame.TextRange.Text = "text1${CrLf}text2"
```

## 図形のパラグラフのインデントを設定する。

```powershell
$ParagraphIndex = 2
$Paragraph = $Shape.TextFrame.TextRange.Paragraphs($ParagraphIndex)
$Paragraph.IndentLevel = 2
```

## 図形の箇条書きをなしにする。

```powershell
# 列挙型を使うために PowerShell のセッションに .NET クラスを定義する。
$SearchPath = 'C:\WINDOWS\assembly\GAC_MSIL'
$SearchFilter = 'Microsoft.Office.Interop.PowerPoint.dll'
$PathToAssemblyItems = Get-ChildItem -LiteralPath $SearchPath -Filter $SearchFilter -Recurse
if ($PathToAssemblyItems.Count -ne 1) {
    throw
}
$PathToAssembly = $PathToAssemblyItems[0].FullName
Add-Type -LiteralPath $PathToAssembly

# 箇条書きをなしにする。
$ppBulletNone = [Microsoft.Office.Interop.PowerPoint.PpBulletType]::ppBulletNone
$Shape.TextFrame.TextRange.ParagraphFormat.Bullet.Type = $ppBulletNone
```

## 図形のテキストボックスを自動調整なしにする。

```powershell
$ppAutoSizeNone = [Microsoft.Office.Interop.PowerPoint.PpAutoSize]::ppAutoSizeNone
$Shape.TextFrame.AutoSize = $ppAutoSizeNone
```

## パラグラフにフォントのサイズや下線を設定する。

```powershell
$ParagraphIndex = 2
$Paragraph = $Shape.TextFrame.TextRange.Paragraphs($ParagraphIndex)
$Paragraph.Font.Size = 32
$Paragraph.Font.Underline = [Microsoft.Office.Core.MsoTriState]::msoTrue
```

## スライドに図形を加える。

```powershell
$msoShapeRectangle = [Microsoft.Office.Core.MsoAutoShapeType]::msoShapeRectangle
$Shape2 = $Slide.Shapes.AddShape($msoShapeRectangle, 10, 20, 30, 40)
```

## 図形の位置を設定する。

```powershell
$Shape2.Left = 127.2
$Shape2.Top = 177.59
$Shape2.Width = 73.75504
$Shape2.Height = 39.93504
```

## 図形の枠線の色を設定する。

```powershell
Add-Type -AssemblyName Microsoft.VisualBasic

$rgb = [Microsoft.VisualBasic.Information]::RGB(0, 0, 0)
$Shape2.Line.ForeColor.RGB = $rgb
```

## 図形を塗りつぶしなしにする。

```powershell
Add-Type -AssemblyName Microsoft.VisualBasic

$msoFalse = [Microsoft.Office.Core.MsoTriState]::msoFalse
$Shape2.Fill.Visible = $msoFalse
```
